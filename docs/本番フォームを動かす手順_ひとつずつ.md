# 本番のサイトで「お問い合わせフォーム」を送れるようにする手順

**プログラミングがわからなくても大丈夫です。**  
下の **ステップ1** から順に、ひとつずつやってください。  
全部できたら、本番の LP（a-melo.com/anella-work-b/）のフォームから、メールや Chatwork に申し込みが届くようになります。

---

## この手順でやること（全体）

1. **GitHub** … LP のデータをネット上に置く（まだなら）
2. **Vercel** … フォームの「送信先」を動かす場所を作る
3. **Vercel に設定** … メールや Chatwork に届くようにする
4. **本番用のファイルを作る** … 1行のコマンドを実行する（または開発者に頼む）
5. **Xサーバーにアップロード** … 作ったファイルを本番サイトに置く

---

## ステップ1: GitHub に LP を上げる（すでにやってある場合は飛ばしてOK）

**目的:** LP のデータを GitHub というサイトに置いておく。Vercel がここから読みに行きます。

1. **Mac の「ターミナル」** を開く（Spotlight で「ターミナル」と検索 → Enter）。
2. 次の **1行** をコピーして貼り付けて Enter。
   ```
   cd /Users/hanakinoboru/Desktop/anella-lp
   ```
3. 次を **1行ずつ** 貼り付けて Enter（3回）。
   ```
   git add .
   ```
   ```
   git commit -m "Anella LP complete"
   ```
   - 「nothing to commit」と出たら、すでに保存済みなので **ステップ2** へ。

4. ブラウザで **https://github.com** を開く → ログイン。
5. 右上 **＋** → **New repository**。
6. **Repository name** に `anella-lp` と入力。**「Add a README file」にはチェックを入れない。**
7. **Create repository** をクリック。
8. 出た画面の **「…or push an existing repository from the command line」** のところに、**2行のコマンド** が書いてあるので、その2行をメモする（あとで使う）。
9. ターミナルに戻り、メモした **1行目** を貼り付けて Enter。  
   （例: `git remote add origin https://github.com/あなたのユーザー名/anella-lp.git`）
10. メモした **2行目** を貼り付けて Enter。  
    （例: `git push -u origin main`）
11. 成功すると、GitHub のページを更新するとファイル一覧が出ます。  
    **ここまでで「GitHub に LP が上がった」状態です。**

※ 詳しくは **STEP_BY_STEP_GITHUB_VERCEL.md** のステップ1〜3も参照できます。

---

## ステップ2: Vercel で「フォーム送信先」用のプロジェクトを作る

**目的:** フォームのデータを受け取って、メールや Chatwork に届ける「受け皿」を、Vercel という無料のサービスで作ります。

1. ブラウザで **https://vercel.com** を開く。
2. **Log In** → **Continue with GitHub** を選び、GitHub でログインする。
3. **Add New…** → **Project** をクリック。
4. 一覧に **anella-lp** が出ているので、その横の **Import** をクリック。
5. **Configure Project** の画面になる。ここで **環境変数を1つだけ追加** する：
   - **Key** の欄に `NEXT_PUBLIC_BASE_PATH` と入力する。
   - **Value** の欄に `/anella-work-b` と入力する（スラッシュも含めてこのまま）。
   - **Environment** で **Production** にチェックが入っていることを確認。
6. **Deploy** をクリックする。
7. 1〜2分待つ。終わると「Congratulations!」のような画面になり、**Visit** や **Domains** に URL が出る。  
   例: `https://anella-lp-xxxx.vercel.app`  
   **この URL をメモする。**（あとで「フォーム送信先の URL」を作るときに使います。）

---

## ステップ3: Vercel に「メールや Chatwork に届けるための設定」を入れる

**目的:** フォームで送られた内容を、メールまたは Chatwork に届くようにします。

1. Vercel の画面で、いま作った **anella-lp** のプロジェクトを開く。
2. 画面上方の **Settings** をクリック。
3. 左のメニューから **Environment Variables** をクリック。
4. 次の **3つ** を、1つずつ追加する。  
   それぞれ **Key** と **Value** を入れて **Save** を押す。**Environment** は **Production** にチェック。

   | Key（名前） | Value（値） |
   |-------------|-------------|
   | `NEXT_PUBLIC_BASE_PATH` | `/anella-work-b` |
   | `RESEND_API_KEY` | （下の「Resend のキーの取り方」で取ったキー） |
   | `CHATWORK_API_TOKEN` | （あなたが持っている Chatwork の API トークン） |
   | `CHATWORK_ROOM_ID` | `422220692`（あなたのルームID） |

   ※ メールだけ使うなら RESEND だけでOK。Chatwork だけでも動きます。

5. 全部入れたら、画面上方の **Deployments** タブをクリック。
6. いちばん上にある「直近のデプロイ」の右側の **⋯（縦に3つの点）** をクリック → **Redeploy** を選ぶ。  
   これで「今入れた設定」が反映されます。

### Resend のキーの取り方（メールで受け取る場合）

1. **https://resend.com** を開く。
2. **Sign Up** またはログイン（Google でも可）。
3. ログイン後、**API Keys** を開く。
4. **Create API Key** → 名前（例: anella-lp）を入れて作成。
5. 表示された **re_ で始まる長い文字列** をコピーする。  
   これが `RESEND_API_KEY` の **Value** に入れる値です。**このキーはあとから見られないので、必ずコピーして保存してください。**

---

## ステップ4: 「フォーム送信先の URL」を決める

**目的:** 本番の LP のフォームが「どこに送るか」の URL を、このステップで確定させます。

あなたの **Vercel の URL** は、ステップ2でメモしたものです。  
例: `https://anella-lp-abc123.vercel.app`

**フォーム送信先の URL** は、そのあとに `/anella-work-b/api/contact` を付けたものです。

- 例: Vercel の URL が `https://anella-lp-abc123.vercel.app` なら  
  **フォーム送信先の URL** は  
  **`https://anella-lp-abc123.vercel.app/anella-work-b/api/contact`**

この **フォーム送信先の URL** をメモする（次のステップで使います）。

---

## ステップ5: 本番用のファイルを作る（Xサーバーにアップロードする用）

**目的:** 本番サイト（a-melo.com/anella-work-b/）に置く「完成した LP のファイル」を、あなたのパソコンで1回だけ作ります。  
**フォームの送信先** を、ステップ4で決めた URL にしておきます。

**この作業は「ターミナルで1行コマンドを実行する」か、開発者に頼んでください。**

1. **Mac の「ターミナル」** を開く。
2. 次の **1行** をコピーする。  
   **`https://あなたのVercelのドメイン/anella-work-b/api/contact`** の部分を、**ステップ4でメモした「フォーム送信先の URL」** に置き換える。

   ```
   cd /Users/hanakinoboru/Desktop/anella-lp && npm ci && BUILD_STATIC=1 NEXT_PUBLIC_BASE_PATH=/anella-work-b NEXT_PUBLIC_CONTACT_API_URL=https://あなたのVercelのドメイン/anella-work-b/api/contact npm run build
   ```

   例（Vercel のドメインが anella-lp-abc123.vercel.app の場合）:
   ```
   cd /Users/hanakinoboru/Desktop/anella-lp && npm ci && BUILD_STATIC=1 NEXT_PUBLIC_BASE_PATH=/anella-work-b NEXT_PUBLIC_CONTACT_API_URL=https://anella-lp-abc123.vercel.app/anella-work-b/api/contact npm run build
   ```

3. ターミナルに貼り付けて Enter。
4. 1〜2分待つ。最後に **「Generating static pages」** などと出て、エラーがなければ完了です。
5. プロジェクトのフォルダ（anella-lp）の中に **`out`** というフォルダができているはずです。  
   **この `out` フォルダの中身** が、本番にアップロードするファイルです。

※ ここで「npm がない」などのエラーが出る場合は、開発者に「本番用に BUILD_STATIC=1 と NEXT_PUBLIC_CONTACT_API_URL を指定して npm run build して、out を出してほしい」と伝えてください。

---

## ステップ6: Xサーバーに「out の中身」をアップロードする

**目的:** ステップ5でできた「本番用の LP」を、実際のサイト（a-melo.com/anella-work-b/）に置きます。

1. Xサーバーの **サーバーパネル** にログインする。
2. **ファイル管理**（または FTP）で、**a-melo.com** の **公開フォルダ（public_html）** を開く。
3. その中に **`anella-work-b`** というフォルダがあることを確認する。なければ作る。
4. **`anella-work-b`** の **中身** を、ステップ5でできた **`out` フォルダの中身** ですべて置き換える。  
   （中身のファイル・フォルダをすべて削除してから、`out` の中身をすべてアップロードする、というイメージです。）

アップロードが終わったら、ブラウザで **https://a-melo.com/anella-work-b/** を開き、LP が表示されるか確認します。

---

## ステップ7: フォームが届くかテストする

1. **https://a-melo.com/anella-work-b/** を開く。
2. ページを下までスクロールし、**お問い合わせフォーム** にテスト用の内容を入れる（お名前・電話番号・メールアドレスは適当でOK）。
3. **「無料見学・体験に申し込む」** をクリックする。
4. 「お申し込みありがとうございます」と出れば送信成功。
5. **メール**（anella.kawasaki@gmail.com など）や **Chatwork** のルームに、申し込み内容が届いているか確認する。

届いていれば **本番のフォームは完了** です。

---

## 用語メモ（わからなくなったとき）

| 言葉 | 意味（ざっくり） |
|------|------------------|
| GitHub | プログラムのデータをネット上に置いておくサービス。Vercel がここから読みに行く。 |
| Vercel | フォームの「送信先」を動かす無料のサービス。ここでメール・Chatwork に届ける設定をする。 |
| 環境変数 | サービス（Vercel）に「メールのキー」や「Chatwork のルームID」などを渡すための「名前」と「値」のセット。 |
| out フォルダ | 本番用にビルドしたときにできるフォルダ。この中身を Xサーバーにアップロードする。 |
| フォーム送信先の URL | フォームのデータを送る先のアドレス。Vercel の URL + `/anella-work-b/api/contact`。 |

---

## つまずいたとき

- **GitHub に push できない（パスワードで通らない）**  
  → GitHub では「パスワード」の代わりに **Personal access token** を使います。  
  GitHub → **Settings** → **Developer settings** → **Personal access tokens** でトークンを作り、そのトークンをパスワードの欄に入れます。

- **Vercel の一覧に anella-lp が出てこない**  
  → ステップ1の `git push` が成功しているか確認。GitHub の anella-lp のページを開いて、ファイルが並んでいれば、Vercel の画面を更新（F5）してみてください。

- **ステップ5のコマンドで「npm がない」と出る**  
  → Node.js が入っていない可能性があります。開発者に「out フォルダを作ってほしい」と頼むか、**STEP_BY_STEP_GITHUB_VERCEL.md** の前の方に Node のインストールの記載がないか確認してください。

- **フォームを送っても届かない**  
  → ステップ3の環境変数（RESEND または Chatwork）が正しく入っているか、ステップ5の `NEXT_PUBLIC_CONTACT_API_URL` が「フォーム送信先の URL」と一致しているか確認。入れたあと Vercel で **Redeploy** したかも確認してください。
